<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hellobike.dao.IUserCollectRecordDao">

<!--    &lt;!&ndash;映射结果集&ndash;&gt;-->
<!--    <resultMap id="recordMap" type="record">-->
<!--        <result property="interfaceName" column="interface_name"/>-->
<!--        <result property="methodName" column="method_name"/>-->
<!--        <result property="params" column="params"/>-->
<!--        <result property="resultParams" column="result_params"/>-->
<!--        <association property="serviceName" javaType="ServiceName">-->
<!--            <id></id>-->
<!--            <result property="service_name" column="service_name"/>-->
<!--            <result property="ip" column="ip"/>-->
<!--            <result property="port" column="port"/>-->
<!--        </association>-->
<!--    </resultMap>-->


    <select id="findIdByRecord" resultType="Integer" parameterType="userCollectRecord">
        select id from t_user_collect_record
        where user_id = #{user_id} and service_id =#{service_id}
                and interface_id =#{interface_id} and method_id = #{method_id}
                and params = #{params} and result_params = #{result_params} ;
    </select>
    <insert id="insertUserCollectRecord" parameterType="userCollectRecord">
        insert into t_user_collect_record(service_id,interface_id,method_id,user_id,params,result_params)
        values(#{service_id},#{interface_id},#{method_id},#{user_id},#{params},#{result_params});
    </insert>

    <delete id="deleteRecordByRecord" parameterType="userCollectRecord">
        delete from t_user_collect_record
        where user_id = #{user_id} and service_id =#{service_id}
                and interface_id =#{interface_id} and method_id = #{method_id}
                and params = #{params} and result_params = #{result_params} ;
    </delete>

    <select id="selectUserCollectRecordByUserId" parameterType="Integer" resultType="resultRecord">
        select
            service_name,ip,port,interface_name,method_name,params,result_params
        from t_user_collect_record tucr
        left join t_service_name tsn on tucr.service_id = tsn.id
        left join t_interface_name tin on tucr.interface_id = tin.id
        left join t_method_name tmn on tucr.method_id = tmn.id;
    </select>
</mapper>